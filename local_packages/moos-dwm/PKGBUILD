pkgname='moos-dwm'
pkgver=20250808
pkgrel=1
pkgdesc='Patched dynamic window manager for X.'
arch=('any')
url='https://tools.suckless.org/dwm/'
license=('MIT')
options=(
    'zipman'
    '!debug'
)
makedepends=('git')
depends=(
    'libx11'
    'libxinerama'
    'libxft'
    'dmenu'
    'moos-system-state'
    'moos-status-bar'
)
provides=('dwm')
conflicts=('dwm')
source=(
    'git+https://git.suckless.org/dwm'
    'dwm.c.patch'
    'config.mk.patch'
    'config.h'
)
sha256sums=(
    'SKIP'
    '2e773dd4f276e2485dd40dd13180322519503c5bea66c639115e39bc72033010'
    '8749849723cb05bcc0c3c34b189220767387c65039504432851ac33558a98bf6'
    '0f25a51df7b5e1d85af088e41de165c84ed67160b7fc540ce27ca352f40e81e3'
)
_repo='dwm'

prepare() {
    cd "$_repo"
    patch < "$srcdir/dwm.c.patch"
    patch < "$srcdir/config.mk.patch"
    cp "$srcdir/config.h" .
}

build() {
    cd "$_repo"
    make
}

package() {
    cd "$_repo"
    make PREFIX="/usr" DESTDIR="$pkgdir/" install
    install -Dm644 "LICENSE" "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
    install -Dm644 "README" "$pkgdir/usr/share/doc/$pkgname/README"
}
